# 松材线虫病知识图谱图像分析系统使用指南

## 🎯 系统概述

本系统基于AI技术实现了松材线虫病图像识别和智能诊断功能，能够：

1. **多实体识别** - 同时识别图像中的植物、昆虫、病症等多种实体
2. **关系推理** - 自动分析实体间的潜在关系
3. **疾病预测** - 基于识别结果进行病害风险评估
4. **知识更新** - 自动将新发现的信息更新到知识图谱

## 🚀 快速启动

### 1. 启动后端服务

```bash
cd src
python main.py
```

后端将在 `http://localhost:8000` 启动

### 2. 启动前端服务

```bash
cd ui
npm install  # 首次运行需要安装依赖
npm run serve
```

前端将在 `http://localhost:8080` 启动

## 📱 系统功能

### 主页 - 知识图谱展示
- 查看完整的松材线虫病知识图谱
- 交互式节点和边的编辑
- 智能添加新实体和关系

### 图像分析页面
- 支持拖拽或点击上传图片
- 实时分析进度展示
- 多标签页结果展示：
  - 🎯 **实体识别**: 检测到的具体实体及其属性
  - 🔗 **关系分析**: 实体间的已知和推理关系
  - 🏥 **疾病预测**: 风险评估和治疗建议
  - 📊 **知识更新**: 新增的知识图谱信息

## 🖼️ 支持的图像类型

### 植物相关
- 马尾松、黑松等不同树种
- 松针、树干、整株照片
- 不同生长阶段的松树

### 昆虫相关
- 松墨天牛等传播媒介
- 昆虫特写或生态照片
- 不同发育阶段的昆虫

### 病害症状
- 松针发黄、变红、脱落
- 树干流脂、变色
- 整体萎蔫症状

### 文件要求
- **格式**: JPG、PNG、GIF
- **大小**: 不超过10MB
- **分辨率**: 建议800×600以上

## 🔧 配置参数说明

### 分析类型
1. **快速识别** - 仅进行基础实体识别
2. **关系分析** - 包含实体间关系推理
3. **完整分析** - 包含预测和知识更新（推荐）

### 置信度阈值
- **默认**: 0.5
- **高精度**: 0.7-0.8 (减少误识别)
- **高召回**: 0.3-0.5 (检测更多可能实体)

### 自动更新知识图谱
- 开启后会自动将新发现的实体和关系添加到知识库
- 建议在生产环境中开启人工审核

## 📊 结果解读

### 置信度级别
- **🟢 高置信度 (80%+)**: 识别结果可信度很高
- **🟡 中等置信度 (60-80%)**: 基本可信，建议人工验证
- **🔴 低置信度 (60%以下)**: 不确定，需要专家确认

### 风险等级
- **🔴 高风险**: 存在明显病害症状，需要立即处理
- **🟡 中风险**: 可能存在早期症状，建议密切监控
- **🟢 低风险**: 暂无明显病害迹象

## 🛠️ 技术架构

### 后端技术栈
- **FastAPI**: Web框架和API服务
- **MySQL**: 知识图谱数据存储
- **OpenCV**: 图像处理
- **Word2Vec**: 语义相似度计算
- **AI推理服务**: 基于Kimi API的智能分析

### 前端技术栈
- **Vue.js 3**: 前端框架
- **Element Plus**: UI组件库
- **D3.js**: 图谱可视化 (通过KnowledgeGraph组件)

### 核心服务模块
1. **ImageAnalysisService**: 图像识别和特征提取
2. **KnowledgeInferenceService**: 疾病预测和治疗建议
3. **MultiEntityAnalyzer**: 多实体关系分析
4. **KnowledgeGraphUpdater**: 动态知识更新

## 🔍 API接口

### 图像分析接口
```
POST /api/image/analyze
- 上传图片文件进行完整分析
- 返回实体、关系、预测、更新信息

POST /api/entities/validate
- 验证多实体间的关系
- 用于复杂场景的关系确认
```

### 辅助接口
```
GET /api/analysis/history
- 获取历史分析记录

GET /api/suggestions/updates
- 获取知识更新建议
```

## 🚨 注意事项

### 图像质量要求
- 确保图像清晰，避免模糊或过度曝光
- 主要识别对象应占据图片的主要部分
- 避免复杂背景干扰

### 系统限制
- 当前版本为演示系统，部分AI识别采用模拟数据
- 生产环境需要训练专用的图像识别模型
- 知识图谱更新需要定期维护和验证

### 性能优化
- 大批量分析建议分批处理
- 定期清理历史分析记录
- 监控数据库存储空间

## 🆘 常见问题

**Q: 上传图片后没有响应怎么办？**
A: 检查图片大小是否超限，网络连接是否正常，后端服务是否运行

**Q: 识别结果不准确怎么办？**
A: 调整置信度阈值，确保图像质量，或联系系统管理员

**Q: 如何添加新的实体类型？**
A: 当前需要在代码中手动添加，未来版本将支持动态配置

**Q: 知识图谱更新太频繁怎么办？**
A: 提高自动更新的置信度阈值，或关闭自动更新改为手动审核

## 📞 技术支持

如有技术问题或功能建议，请联系开发团队。

---

**系统版本**: v1.0  
**最后更新**: 2024年12月  
**开发团队**: 知识工程课程项目组